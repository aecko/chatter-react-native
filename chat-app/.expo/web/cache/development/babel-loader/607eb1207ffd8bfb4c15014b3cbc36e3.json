{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Seamus\\\\Documents\\\\ChatApp\\\\chat-app\\\\App.js\";\nimport React, { useEffect, useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport useWindowDimensions from \"react-native-web/dist/exports/useWindowDimensions\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport { createAppContainer } from 'react-navigation';\nimport { createStackNavigator } from 'react-navigation-stack';\nimport NavBar from \"./components/NavBar\";\nimport ChatBox from \"./screens/ChatBox\";\nimport LoginScreen from \"./screens/LoginScreen\";\nimport AuthContext from \"./contexts/AuthContext\";\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nimport 'firebase/auth';\nimport * as FirebaseCore from 'expo-firebase-core';\nimport { useAuthState } from 'react-firebase-hooks/auth';\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\nimport * as GoogleSignIn from 'expo-google-sign-in';\n\nif (!firebase.apps.length) {\n  firebase.initializeApp(FirebaseCore.DEFAULT_APP_OPTIONS);\n} else {\n  firebase.app();\n}\n\nvar auth = firebase.auth();\nvar firestore = firebase.firestore();\nvar MainNavigator = createStackNavigator({\n  Chat: ChatBox\n}, {\n  headerMode: 'none'\n});\nvar AppNavigator = createAppContainer(MainNavigator);\nexport default function App() {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      userMobile = _useState2[0],\n      setUserMobile = _useState2[1];\n\n  var _useAuthState = useAuthState(auth),\n      _useAuthState2 = _slicedToArray(_useAuthState, 1),\n      user = _useAuthState2[0];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      roomCode = _useState4[0],\n      setRoomCode = _useState4[1];\n\n  var messageRef = null;\n  var query = null;\n\n  var _useCollectionData = useCollectionData(query, {\n    idField: 'id'\n  }),\n      _useCollectionData2 = _slicedToArray(_useCollectionData, 1),\n      messages = _useCollectionData2[0];\n\n  console.log('hellooo');\n  useEffect(function () {\n    messageRef = firestore.collection('messages' + roomCode);\n    query = messageRef.orderBy('createdAt', 'desc').limit(25);\n\n    if (Platform.OS == 'android' || Platform.OS == 'ios') {\n      initAsync();\n    }\n  }, [query]);\n  var value = {\n    auth: auth,\n    firestore: firestore,\n    messageRef: messageRef,\n    messages: messages\n  };\n  var styles = StyleSheet.create({\n    container: {\n      flex: 1,\n      flexDirection: 'column',\n      flexGrow: 0,\n      justifyContent: 'center',\n      backgroundColor: '#125495'\n    }\n  });\n\n  var initAsync = function initAsync() {\n    return _regeneratorRuntime.async(function initAsync$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(GoogleSignIn.initAsync());\n\n          case 2:\n            _syncUserWithStateAsync();\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _syncUserWithStateAsync = function _syncUserWithStateAsync() {\n    var userMobileNew;\n    return _regeneratorRuntime.async(function _syncUserWithStateAsync$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(GoogleSignIn.signInSilentlyAsync());\n\n          case 2:\n            userMobileNew = _context2.sent;\n            setUserMobile(userMobileNew);\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var signOutAsync = function signOutAsync() {\n    return _regeneratorRuntime.async(function signOutAsync$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(GoogleSignIn.signOutAsync());\n\n          case 2:\n            setUserMobile(null);\n\n          case 3:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var signInAsync = function signInAsync() {\n    var _await$GoogleSignIn$s, type, _user, message;\n\n    return _regeneratorRuntime.async(function signInAsync$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            _context4.next = 3;\n            return _regeneratorRuntime.awrap(GoogleSignIn.askForPlayServicesAsync());\n\n          case 3:\n            _context4.next = 5;\n            return _regeneratorRuntime.awrap(GoogleSignIn.signInAsync());\n\n          case 5:\n            _await$GoogleSignIn$s = _context4.sent;\n            type = _await$GoogleSignIn$s.type;\n            _user = _await$GoogleSignIn$s.user;\n\n            if (type === 'success') {\n              _syncUserWithStateAsync();\n\n              console.log('signed in');\n            }\n\n            _context4.next = 15;\n            break;\n\n          case 11:\n            _context4.prev = 11;\n            _context4.t0 = _context4[\"catch\"](0);\n            message = _context4.t0.message;\n            alert('login: Error:' + message);\n\n          case 15:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[0, 11]], Promise);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 5\n    }\n  }, React.createElement(AuthContext.Provider, {\n    value: value,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, React.createElement(NavBar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }), user ? React.createElement(ChatBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 19\n    }\n  }) : React.createElement(LoginScreen, {\n    googleLogin: signInAsync,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 33\n    }\n  })));\n}","map":{"version":3,"sources":["C:/Users/Seamus/Documents/ChatApp/chat-app/App.js"],"names":["React","useEffect","useState","createAppContainer","createStackNavigator","NavBar","ChatBox","LoginScreen","AuthContext","firebase","FirebaseCore","useAuthState","useCollectionData","GoogleSignIn","apps","length","initializeApp","DEFAULT_APP_OPTIONS","app","auth","firestore","MainNavigator","Chat","headerMode","AppNavigator","App","userMobile","setUserMobile","user","roomCode","setRoomCode","messageRef","query","idField","messages","console","log","collection","orderBy","limit","Platform","OS","initAsync","value","styles","StyleSheet","create","container","flex","flexDirection","flexGrow","justifyContent","backgroundColor","_syncUserWithStateAsync","signInSilentlyAsync","userMobileNew","signOutAsync","signInAsync","askForPlayServicesAsync","type","message","alert"],"mappings":"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","sourcesContent":["//import react features\nimport React, { useEffect, useState } from 'react';\nimport { StyleSheet, Text, View, useWindowDimensions, Button, Platform } from 'react-native';\n\nimport { createAppContainer } from 'react-navigation'\nimport { createStackNavigator } from 'react-navigation-stack'\n\n//import conponents\nimport NavBar from './components/NavBar';\nimport ChatBox from './screens/ChatBox';\nimport LoginScreen from './screens/LoginScreen';\n\n//import contexts\nimport AuthContext from './contexts/AuthContext'\n\n//import firebase utils\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nimport 'firebase/auth';\nimport * as FirebaseCore from 'expo-firebase-core';\nimport { useAuthState } from 'react-firebase-hooks/auth'\nimport { useCollectionData } from 'react-firebase-hooks/firestore';\n\n//import mobile google signin\nimport * as GoogleSignIn from 'expo-google-sign-in';\n\n//initilase firebase\nif (!firebase.apps.length) {\n  firebase.initializeApp(FirebaseCore.DEFAULT_APP_OPTIONS);\n}else {\n  firebase.app(); // if already initialized, use that one\n}\nconst auth = firebase.auth();\nconst firestore = firebase.firestore()\n\n\n//create navigator stack\nconst MainNavigator = createStackNavigator(\n  {\n    Chat: ChatBox\n  },\n  {\n    headerMode: 'none'\n  }\n)\nconst AppNavigator = createAppContainer(MainNavigator)\n\n\nexport default function App() {\n  //states\n  const [userMobile, setUserMobile] = useState(null);\n  const [user] = useAuthState(auth);\n  const [roomCode, setRoomCode] = useState('')\n\n  var messageRef = null;\n  var query = null;\n  const [messages] = useCollectionData(query, { idField: 'id' })\n  console.log('hellooo')\n\n  useEffect(() => {\n    messageRef = firestore.collection('messages' + roomCode);\n    query = messageRef.orderBy('createdAt', 'desc').limit(25);\n    if(Platform.OS == 'android' || Platform.OS== 'ios'){\n      initAsync()\n    }\n  }, [query])\n\n\n\n  //setup context provider values\n  const value = { auth, firestore, messageRef, messages }\n\n  //style sheet for app\n  const styles = StyleSheet.create({\n    container: {\n      flex: 1,\n      flexDirection: 'column',\n      flexGrow: 0,\n      justifyContent: 'center',\n      backgroundColor: '#125495',\n    },\n  });\n\n  //////////////google sign in stuff\n\n\n  const initAsync = async () => {\n    await GoogleSignIn.initAsync();\n    _syncUserWithStateAsync();\n  };\n\n  const _syncUserWithStateAsync = async () => {\n    const userMobileNew = await GoogleSignIn.signInSilentlyAsync();\n    setUserMobile(userMobileNew)\n  };\n\n\n  const signOutAsync = async () => {\n    await GoogleSignIn.signOutAsync();\n    setUserMobile(null)\n  };\n  const signInAsync = async () => {\n    try {\n      await GoogleSignIn.askForPlayServicesAsync();\n      const { type, user } = await GoogleSignIn.signInAsync();\n      if (type === 'success') {\n        _syncUserWithStateAsync();\n        console.log('signed in')\n      }\n    } catch ({ message }) {\n      alert('login: Error:' + message);\n    }\n  };\n///////////\n\n  return (\n    <View style={styles.container}>\n        <AuthContext.Provider value={value}>\n          <NavBar />\n          {user ? <ChatBox /> : <LoginScreen googleLogin={signInAsync} />}\n        </AuthContext.Provider>\n    </View>\n  )\n}\n\n\n"]},"metadata":{},"sourceType":"module"}